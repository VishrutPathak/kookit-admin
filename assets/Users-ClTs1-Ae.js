import{r as i,l as S,j as e,c as U,s as p}from"./index-4xmnvLmg.js";import{u as v}from"./users-DNrr3Qg9.js";function A(){const[n,r]=i.useState([]),[d,f]=i.useState("all"),[m,u]=i.useState(""),[l,c]=i.useState(null);i.useEffect(()=>{try{const t=S("kookit_users",null)?.users??v?.users??[];r(Array.isArray(t)?t:[])}catch(s){console.error("Failed to load users:",s),r([])}},[]);const h=s=>{r(s),p("kookit_users",{users:s})},g=()=>{const s=prompt("Name"),t=prompt("Phone");if(!s||!t)return;const x={id:U("u"),name:s,phone:t,status:"active",joined:new Date().toISOString().slice(0,10)};h([x,...n])},k=s=>{confirm("Delete user?")&&h(n.filter(t=>t.id!==s))},j=s=>{h(n.map(t=>t.id===s?{...t,status:t.status==="active"?"inactive":"active"}:t))},C=()=>{const s=v?.users??[];p("kookit_users",{users:s}),r(Array.isArray(s)?s:[])},w=()=>{const s=[["id","name","phone","status","joined"]];n.forEach(a=>s.push([a.id,a.name,a.phone,a.status,a.joined]));const t=s.map(a=>a.map(y=>`"${String(y??"").replace(/"/g,'""')}"`).join(",")).join(`
`),x=new Blob([t],{type:"text/csv;charset=utf-8;"}),N=URL.createObjectURL(x),o=document.createElement("a");o.href=N,o.download=`kookit_users_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(N)},b=(n||[]).filter(s=>{if(d!=="all"&&s.status!==d)return!1;if(!m)return!0;const t=m.toLowerCase();return(s.name||"").toLowerCase().includes(t)||(s.phone||"").toLowerCase().includes(t)||(s.id||"").toLowerCase().includes(t)});return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-start gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Users"}),e.jsx("div",{className:"text-muted small",children:"Manage users, toggle status, export data"})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsxs("div",{className:"input-group input-group-sm me-2",style:{minWidth:220},children:[e.jsx("input",{className:"form-control form-control-sm",placeholder:"Search name / phone / id",value:m,onChange:s=>u(s.target.value)}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:()=>u(""),children:"Clear"})]}),e.jsxs("select",{className:"form-select form-select-sm me-2",value:d,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:g,children:"Add User"}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:C,children:"Reset"}),e.jsx("button",{className:"btn btn-outline-success btn-sm",onClick:w,children:"Export CSV"})]})]}),e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body table-responsive",children:e.jsxs("table",{className:"table table-sm align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:b.length>0?b.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{cursor:"pointer"},onClick:()=>c(s),children:[e.jsx("div",{className:"fw-semibold",children:s.name}),e.jsx("div",{className:"text-muted small",children:s.id})]})}),e.jsx("td",{children:s.phone}),e.jsx("td",{children:s.joined?new Date(s.joined).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.status==="active"?"bg-success":"bg-secondary"}`,children:s.status})}),e.jsxs("td",{className:"text-end",children:[e.jsx("button",{className:"btn btn-sm btn-outline-warning me-1",onClick:()=>j(s.id),children:"Toggle"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>k(s.id),children:"Delete"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center text-muted",children:"No users"})})})]})})}),l&&e.jsxs("div",{className:"modal show d-block",tabIndex:"-1",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"modal-dialog modal-sm",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"User details"}),e.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:()=>c(null)})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("dl",{className:"row mb-0",children:[e.jsx("dt",{className:"col-4",children:"ID"}),e.jsx("dd",{className:"col-8",children:l.id}),e.jsx("dt",{className:"col-4",children:"Name"}),e.jsx("dd",{className:"col-8",children:l.name}),e.jsx("dt",{className:"col-4",children:"Phone"}),e.jsx("dd",{className:"col-8",children:l.phone}),e.jsx("dt",{className:"col-4",children:"Status"}),e.jsx("dd",{className:"col-8",children:l.status}),e.jsx("dt",{className:"col-4",children:"Joined"}),e.jsx("dd",{className:"col-8",children:l.joined})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>{c(null)},children:"Close"}),e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>{j(l.id),c(s=>({...s,status:s.status==="active"?"inactive":"active"}))},children:"Toggle status"})]})]})}),e.jsx("div",{className:"modal-backdrop fade show",onClick:()=>c(null)})]})]})}export{A as default};
